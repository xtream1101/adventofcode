import os
import sys


def load_input(file_name):
    input_file = os.path.join(os.path.dirname(sys.argv[0]), file_name)
    with open(input_file) as f:
        lines = f.read().splitlines()
    return lines


def run(program):
    queue = []
    for cmd in program:
        match cmd.split():
            case ['addx', amount]:
                queue.extend([0, int(amount)])
            case ['noop']:
                queue.append(0)

    crt = []
    for cycle_idx in range(len(queue)):
        register = 1 + sum(queue[:cycle_idx])

        sprite_pos = list(range(register - 1, register + 2))
        if cycle_idx % 40 in sprite_pos:
            crt.append('#')
        else:
            crt.append('.')

    return crt


def draw_crt(crt):
    for cycle_value in [40, 80, 120, 160, 200, 240]:
        print(''.join(crt[cycle_value-40:cycle_value]))


test_ans = run(load_input('test_input.txt'))
draw_crt(test_ans)
assert test_ans == ['#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '.', '.', '#', '#', '#', '.', '.', '.', '#', '#', '#', '.', '.', '.', '#', '#', '#', '.', '.', '.', '#', '#', '#', '.', '.', '.', '#', '#', '#', '.', '.', '.', '#', '#', '#', '.', '.', '.', '#', '#', '#', '.', '#', '#', '#', '#', '.', '.', '.', '.', '#', '#', '#', '#', '.', '.', '.', '.', '#', '#', '#', '#', '.', '.', '.', '.', '#', '#', '#', '#', '.', '.', '.', '.', '#', '#', '#', '#', '.', '.', '.', '.', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.', '.', '.', '#', '#', '#', '#', '#', '#', '#', '.', '.', '.', '.', '.']

print('\n')

ans = run(load_input('input.txt'))
assert ans == ['#', '#', '#', '#', '.', '#', '#', '#', '#', '.', '#', '#', '#', '.', '.', '#', '#', '#', '#', '.', '#', '.', '.', '#', '.', '.', '#', '#', '.', '.', '#', '.', '.', '#', '.', '#', '#', '#', '.', '.', '.', '.', '.', '#', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '.', '#', '.', '#', '.', '.', '#', '.', '#', '.', '.', '#', '.', '.', '.', '#', '.', '.', '#', '#', '#', '.', '.', '#', '#', '#', '.', '.', '#', '#', '#', '.', '.', '#', '#', '#', '#', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '.', '#', '.', '.', '#', '.', '.', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '#', '#', '.', '#', '.', '.', '#', '.', '#', '#', '#', '.', '.', '#', '.', '.', '.', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '#', '.', '.', '#', '.', '#', '.', '.', '#', '.', '#', '.', '.', '.', '.', '#', '#', '#', '#', '.', '#', '.', '.', '.', '.', '#', '#', '#', '.', '.', '#', '.', '.', '.', '.', '#', '.', '.', '#', '.', '.', '#', '#', '#', '.', '.', '#', '#', '.', '.', '#', '.', '.', '.', '.']
# ZFBFHGUP
draw_crt(ans)
